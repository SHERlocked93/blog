# GraphQL ä»Žå…¥é—¨åˆ°å®žè·µ
[TOC]

![](https://i.loli.net/2019/03/12/5c87a1cfe83e9.jpg)

æœ¬æ–‡é¦–å…ˆä»‹ç»äº† GraphQLï¼Œå†é€šè¿‡ MongoDB + graphql + graph-pack çš„ç»„åˆå®žæˆ˜åº”ç”¨ GraphQLï¼Œè¯¦ç»†é˜è¿°å¦‚ä½•ä½¿ç”¨ GraphQL æ¥è¿›è¡Œå¢žåˆ æ”¹æŸ¥å’Œæ•°æ®è®¢é˜…æŽ¨é€ï¼Œå¹¶é™„æœ‰ä½¿ç”¨ç¤ºä¾‹ï¼Œè¾¹ç”¨è¾¹å­¦å°è±¡æ·±åˆ»~

å¦‚æžœå¸Œæœ›å°† GraphQL åº”ç”¨åˆ°å‰åŽç«¯åˆ†ç¦»çš„ç”Ÿäº§çŽ¯å¢ƒï¼Œè¯·æœŸå¾…åŽç»­æ–‡ç« ã€‚

æœ¬æ–‡å®žä¾‹ä»£ç ï¼š[Github](https://github.com/SHERlocked93/graphql-demo)

## 0. ä»€ä¹ˆæ˜¯ GraphQL

GraphQL æ˜¯ä¸€ç§é¢å‘æ•°æ®çš„ API æŸ¥è¯¢é£Žæ ¼ã€‚

ä¼ ç»Ÿçš„ API æ‹¿åˆ°çš„æ˜¯å‰åŽç«¯çº¦å®šå¥½çš„æ•°æ®æ ¼å¼ï¼ŒGraphQL å¯¹ API ä¸­çš„æ•°æ®æä¾›äº†ä¸€å¥—æ˜“äºŽç†è§£çš„å®Œæ•´æè¿°ï¼Œå®¢æˆ·ç«¯èƒ½å¤Ÿå‡†ç¡®åœ°èŽ·å¾—å®ƒéœ€è¦çš„æ•°æ®ï¼Œæ²¡æœ‰ä»»ä½•å†—ä½™ï¼Œä¹Ÿè®© API æ›´å®¹æ˜“åœ°éšç€æ—¶é—´æŽ¨ç§»è€Œæ¼”è¿›ï¼Œè¿˜èƒ½ç”¨äºŽæž„å»ºå¼ºå¤§çš„å¼€å‘è€…å·¥å…·ã€‚

## 1. æ¦‚è¿°

å‰ç«¯çš„å¼€å‘éšç€ SPA æ¡†æž¶å…¨é¢æ™®åŠï¼Œç»„ä»¶åŒ–å¼€å‘ä¹Ÿéšä¹‹æˆä¸ºå¤§åŠ¿æ‰€è¶‹ï¼Œå„ä¸ªç»„ä»¶åˆ†åˆ«ç®¡ç†ç€å„è‡ªçš„çŠ¶æ€ï¼Œç»„ä»¶åŒ–ç»™å‰ç«¯ä»”å¸¦æ¥ä¾¿åˆ©çš„åŒæ—¶ä¹Ÿå¸¦æ¥äº†ä¸€äº›çƒ¦æ¼ã€‚æ¯”å¦‚ï¼Œç»„ä»¶éœ€è¦è´Ÿè´£æŠŠå¼‚æ­¥è¯·æ±‚çš„çŠ¶æ€åˆ†å‘ç»™å­ç»„ä»¶æˆ–é€šçŸ¥ç»™çˆ¶ç»„ä»¶ï¼Œè¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œç”±ç»„ä»¶é—´é€šä¿¡å¸¦æ¥çš„ç»“æž„å¤æ‚åº¦ã€æ¥æºä¸æ˜Žçš„æ•°æ®æºã€ä¸çŸ¥ä»Žä½•è®¢é˜…çš„æ•°æ®å“åº”ä¼šä½¿å¾—æ•°æ®æµå˜å¾—æ‚ä¹±æ— ç« ï¼Œä¹Ÿä½¿å¾—ä»£ç å¯è¯»æ€§å˜å·®ï¼Œä»¥åŠå¯ç»´æŠ¤æ€§çš„é™ä½Žï¼Œä¸ºä»¥åŽé¡¹ç›®çš„è¿­ä»£å¸¦æ¥æžå¤§å›°éš¾ã€‚

è¯•æƒ³ä¸€ä¸‹ä½ éƒ½å¼€å‘å®Œäº†ï¼Œäº§å“å‘Šè¯‰ä½ è¦å¤§æ”¹ä¸€ç•ªï¼Œä»ŽæŽ¥å£åˆ°ç»„ä»¶ç»“æž„éƒ½å¾—æ”¹ï¼ŒåŽç«¯ä¹Ÿéª‚éª‚å’§å’§ä¸æ„¿é…åˆè®©ä½ ä»Žå¥½å‡ ä¸ª API é‡Œå–æ•°æ®è‡ªå·±ç»„åˆï¼Œè¿™é…¸çˆ½ ðŸ˜…

åœ¨ä¸€äº›äº§å“é“¾å¤æ‚çš„åœºæ™¯ï¼ŒåŽç«¯éœ€è¦æä¾›å¯¹åº” WebAppã€WebPCã€APPã€å°ç¨‹åºã€å¿«åº”ç”¨ç­‰å„ç«¯ APIï¼Œæ­¤æ—¶ API çš„ç²’åº¦å¤§å°å°±æ˜¾å¾—æ ¼å¤–é‡è¦ï¼Œç²—ç²’åº¦ä¼šå¯¼è‡´ç§»åŠ¨ç«¯ä¸å¿…è¦çš„æµé‡æŸè€—ï¼Œç»†ç²’åº¦åˆ™ä¼šé€ æˆå‡½æ•°çˆ†ç‚¸ (Function Explosion)ï¼›åœ¨æ­¤æƒ…æ™¯ä¸‹ Facebook çš„å·¥ç¨‹å¸ˆäºŽ 2015 å¹´å¼€æºäº† **GraphQL** è§„èŒƒï¼Œè®©å‰ç«¯è‡ªå·±æè¿°è‡ªå·±å¸Œæœ›çš„æ•°æ®å½¢å¼ï¼ŒæœåŠ¡ç«¯åˆ™è¿”å›žå‰ç«¯æ‰€æè¿°çš„æ•°æ®ç»“æž„ã€‚

ç®€å•ä½¿ç”¨å¯ä»¥å‚ç…§ä¸‹é¢è¿™ä¸ªå›¾ï¼š

![](https://i.loli.net/2019/03/10/5c84b1dca1c5f.gif)

æ¯”å¦‚å‰ç«¯å¸Œæœ›è¿”å›žä¸€ä¸ª ID ä¸º `233` çš„ç”¨æˆ·çš„åç§°å’Œæ€§åˆ«ï¼Œå¹¶æŸ¥æ‰¾è¿™ä¸ªç”¨æˆ·çš„å‰åä¸ªé›‡å‘˜çš„åå­—å’Œ Emailï¼Œå†æ‰¾åˆ°è¿™ä¸ªäººçˆ¶äº²çš„ç”µè¯ï¼Œå’Œè¿™ä¸ªçˆ¶äº²çš„ç‹—çš„åå­—ï¼ˆåˆ«é—®æˆ‘ä¸ºä»€ä¹ˆæœ‰è¿™ä¹ˆå¥‡æ€ªçš„æŸ¥æ‰¾ ðŸ¤ªï¼‰ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥é€šè¿‡ GraphQL çš„ä¸€æ¬¡ query æ‹¿åˆ°å…¨éƒ¨ä¿¡æ¯ï¼Œæ— éœ€ä»Žå¥½å‡ ä¸ªå¼‚æ­¥ API é‡Œé¢æ¥å›žæ‰¾ï¼š

```graphql
query {
  user (id : "233") {
    name
    gender
    employee (first: 10) {
      name
      email
    }
    father {
      telephone
      dog {
          name
      }
    }
  }
}
```

è¿”å›žçš„æ•°æ®æ ¼å¼åˆ™åˆšå¥½æ˜¯å‰ç«¯æä¾›çš„æ•°æ®æ ¼å¼ï¼Œä¸å¤šä¸å°‘ï¼Œæ˜¯ä¸æ˜¯å¿ƒåŠ¨äº† ðŸ˜

## 2. å‡ ä¸ªé‡è¦æ¦‚å¿µ

è¿™é‡Œå…ˆä»‹ç»å‡ ä¸ªå¯¹ç†è§£ GraphQL æ¯”è¾ƒé‡è¦çš„æ¦‚å¿µï¼Œå…¶ä»–ç±»ä¼¼äºŽæŒ‡ä»¤ã€è”åˆç±»åž‹ã€å†…è”ç‰‡æ®µç­‰æ›´å¤æ‚çš„ç”¨æ³•ï¼Œå‚è€ƒ [GraphQL](http://graphql.cn/learn/queries/) å®˜ç½‘æ–‡æ¡£ ~

### 2.1 æ“ä½œç±»åž‹ Operation Type

GraphQL çš„æ“ä½œç±»åž‹å¯ä»¥æ˜¯ `query`ã€`mutation` æˆ– `subscription`ï¼Œæè¿°å®¢æˆ·ç«¯å¸Œæœ›è¿›è¡Œä»€ä¹ˆæ ·çš„æ“ä½œ

1. query æŸ¥è¯¢ï¼šèŽ·å–æ•°æ®ï¼Œæ¯”å¦‚æŸ¥æ‰¾ï¼ŒCRUD ä¸­çš„ R
2. mutation å˜æ›´ï¼šå¯¹æ•°æ®è¿›è¡Œå˜æ›´ï¼Œæ¯”å¦‚å¢žåŠ ã€åˆ é™¤ã€ä¿®æ”¹ï¼ŒCRUD ä¸­çš„ CUD
3. substription è®¢é˜…ï¼šå½“æ•°æ®å‘ç”Ÿæ›´æ”¹ï¼Œè¿›è¡Œæ¶ˆæ¯æŽ¨é€

è¿™äº›æ“ä½œç±»åž‹éƒ½å°†åœ¨åŽæ–‡å®žé™…ç”¨åˆ°ï¼Œæ¯”å¦‚è¿™é‡Œè¿›è¡Œä¸€ä¸ªæŸ¥è¯¢æ“ä½œ

```graphql
query {
  user { id }
}
```

### 2.2 å¯¹è±¡ç±»åž‹å’Œæ ‡é‡ç±»åž‹ Object Type & Scalar Type

å¦‚æžœä¸€ä¸ª GraphQL æœåŠ¡æŽ¥å—åˆ°äº†ä¸€ä¸ª `query`ï¼Œé‚£ä¹ˆè¿™ä¸ª `query` å°†ä»Ž `Root Query` å¼€å§‹æŸ¥æ‰¾ï¼Œæ‰¾åˆ°å¯¹è±¡ç±»åž‹ï¼ˆObject Typeï¼‰æ—¶åˆ™ä½¿ç”¨å®ƒçš„è§£æžå‡½æ•° Resolver æ¥èŽ·å–å†…å®¹ï¼Œå¦‚æžœè¿”å›žçš„æ˜¯å¯¹è±¡ç±»åž‹åˆ™ç»§ç»­ä½¿ç”¨è§£æžå‡½æ•°èŽ·å–å†…å®¹ï¼Œå¦‚æžœè¿”å›žçš„æ˜¯æ ‡é‡ç±»åž‹ï¼ˆScalar Typeï¼‰åˆ™ç»“æŸèŽ·å–ï¼Œç›´åˆ°æ‰¾åˆ°æœ€åŽä¸€ä¸ªæ ‡é‡ç±»åž‹ã€‚

1. å¯¹è±¡ç±»åž‹ï¼šç”¨æˆ·åœ¨ schema ä¸­å®šä¹‰çš„ `type`
2. æ ‡é‡ç±»åž‹ï¼šGraphQL ä¸­å†…ç½®æœ‰ä¸€äº›æ ‡é‡ç±»åž‹ `String`ã€`Int`ã€`Float`ã€`Boolean`ã€`ID`ï¼Œç”¨æˆ·ä¹Ÿå¯ä»¥å®šä¹‰è‡ªå·±çš„æ ‡é‡ç±»åž‹

æ¯”å¦‚åœ¨ Schema ä¸­å£°æ˜Ž

```graphql
type User {
  name: String!
  age: Int
}
```

è¿™ä¸ª `User` å¯¹è±¡ç±»åž‹æœ‰ä¸¤ä¸ªå­—æ®µï¼Œname å­—æ®µæ˜¯ä¸€ä¸ªä¸º `String` çš„éžç©ºæ ‡é‡ï¼Œage å­—æ®µä¸ºä¸€ä¸ª `Int` çš„å¯ç©ºæ ‡é‡ã€‚

### 2.3 æ¨¡å¼ Schema

å¦‚æžœä½ ç”¨è¿‡ MongoOSEï¼Œé‚£ä½ åº”è¯¥å¯¹ Schema è¿™ä¸ªæ¦‚å¿µå¾ˆç†Ÿæ‚‰ï¼Œç¿»è¯‘è¿‡æ¥æ˜¯ã€Žæ¨¡å¼ã€ã€‚

å®ƒå®šä¹‰äº†å­—æ®µçš„ç±»åž‹ã€æ•°æ®çš„ç»“æž„ï¼Œæè¿°äº†æŽ¥å£æ•°æ®è¯·æ±‚çš„è§„åˆ™ï¼Œå½“æˆ‘ä»¬è¿›è¡Œä¸€äº›é”™è¯¯çš„æŸ¥è¯¢çš„æ—¶å€™ GraphQL å¼•æ“Žä¼šè´Ÿè´£å‘Šè¯‰æˆ‘ä»¬å“ªé‡Œæœ‰é—®é¢˜ï¼Œå’Œè¯¦ç»†çš„é”™è¯¯ä¿¡æ¯ï¼Œå¯¹å¼€å‘è°ƒè¯•ååˆ†å‹å¥½ã€‚

Schema ä½¿ç”¨ä¸€ä¸ªç®€å•çš„å¼ºç±»åž‹æ¨¡å¼è¯­æ³•ï¼Œç§°ä¸ºæ¨¡å¼æè¿°è¯­è¨€ï¼ˆSchema Definition Language, SDLï¼‰ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ä¸€ä¸ªçœŸå®žçš„ä¾‹å­æ¥å±•ç¤ºä¸€ä¸‹ä¸€ä¸ªçœŸå®žçš„ Schema æ–‡ä»¶æ˜¯æ€Žä¹ˆç”¨ SDL ç¼–å†™çš„ï¼š

```graphql
# src/schema.graphql

# Query å…¥å£
type Query {
    hello: String
    users: [User]!
    user(id: String): [User]!
}

# Mutation å…¥å£
type Mutation {
    createUser(id: ID!, name: String!, email: String!, age: Int,gender: Gender): User!
    updateUser(id: ID!, name: String, email: String, age: Int, gender: Gender): User!
    deleteUser(id: ID!): User
}

# Subscription å…¥å£
type Subscription {
    subsUser(id: ID!): User
}

type User implements UserInterface {
    id: ID!
    name: String!
    age: Int
    gender: Gender
    email: String!
}

# æžšä¸¾ç±»åž‹
enum Gender {
    MAN
    WOMAN
}

# æŽ¥å£ç±»åž‹
interface UserInterface {
    id: ID!
    name: String!
    age: Int
    gender: Gender
}
```

è¿™ä¸ªç®€å•çš„ Schema æ–‡ä»¶ä»Ž Queryã€Mutationã€Subscription å…¥å£å¼€å§‹å®šä¹‰äº†å„ä¸ªå¯¹è±¡ç±»åž‹æˆ–æ ‡é‡ç±»åž‹ï¼Œè¿™äº›å­—æ®µçš„ç±»åž‹ä¹Ÿå¯èƒ½æ˜¯å…¶ä»–çš„å¯¹è±¡ç±»åž‹æˆ–æ ‡é‡ç±»åž‹ï¼Œç»„æˆä¸€ä¸ªæ ‘å½¢çš„ç»“æž„ï¼Œè€Œç”¨æˆ·åœ¨å‘æœåŠ¡ç«¯å‘é€è¯·æ±‚çš„æ—¶å€™ï¼Œæ²¿ç€è¿™ä¸ªæ ‘é€‰æ‹©ä¸€ä¸ªæˆ–å¤šä¸ªåˆ†æ”¯å°±å¯ä»¥èŽ·å–å¤šç»„ä¿¡æ¯ã€‚

æ³¨æ„ï¼š**åœ¨ Query æŸ¥è¯¢å­—æ®µæ—¶ï¼Œæ˜¯å¹¶è¡Œæ‰§è¡Œçš„ï¼Œè€Œåœ¨ Mutation å˜æ›´çš„æ—¶å€™ï¼Œæ˜¯çº¿æ€§æ‰§è¡Œï¼Œä¸€ä¸ªæŽ¥ç€ä¸€ä¸ª**ï¼Œé˜²æ­¢åŒæ—¶å˜æ›´å¸¦æ¥çš„ç«žæ€é—®é¢˜ï¼Œæ¯”å¦‚è¯´æˆ‘ä»¬åœ¨ä¸€ä¸ªè¯·æ±‚ä¸­å‘é€äº†ä¸¤ä¸ª Mutationï¼Œé‚£ä¹ˆå‰ä¸€ä¸ªå°†å§‹ç»ˆåœ¨åŽä¸€ä¸ªä¹‹å‰æ‰§è¡Œã€‚

### 2.4 è§£æžå‡½æ•° Resolver

å‰ç«¯è¯·æ±‚ä¿¡æ¯åˆ°è¾¾åŽç«¯ä¹‹åŽï¼Œéœ€è¦ç”±è§£æžå‡½æ•° [Resolver](https://www.apollographql.com/docs/graphql-tools/resolvers.html) æ¥æä¾›æ•°æ®ï¼Œæ¯”å¦‚è¿™æ ·ä¸€ä¸ª Queryï¼š

```graphql
query {
  hello
}
```

é‚£ä¹ˆåŒåçš„è§£æžå‡½æ•°åº”è¯¥æ˜¯è¿™æ ·çš„

```js
Query: {
  hello (parent, args, context, info) {
    return ...
  }
}
```

è§£æžå‡½æ•°æŽ¥å—å››ä¸ªå‚æ•°ï¼Œåˆ†åˆ«ä¸º

1. `parent`ï¼šå½“å‰ä¸Šä¸€ä¸ªè§£æžå‡½æ•°çš„è¿”å›žå€¼
2. `args`ï¼šæŸ¥è¯¢ä¸­ä¼ å…¥çš„å‚æ•°
3. `context`ï¼šæä¾›ç»™æ‰€æœ‰è§£æžå™¨çš„ä¸Šä¸‹æ–‡ä¿¡æ¯
4. `info`ï¼šä¸€ä¸ªä¿å­˜ä¸Žå½“å‰æŸ¥è¯¢ç›¸å…³çš„å­—æ®µç‰¹å®šä¿¡æ¯ä»¥åŠ schema è¯¦ç»†ä¿¡æ¯çš„å€¼

è§£æžå‡½æ•°çš„è¿”å›žå€¼å¯ä»¥æ˜¯ä¸€ä¸ªå…·ä½“çš„å€¼ï¼Œä¹Ÿå¯ä»¥æ˜¯ Promise æˆ– Promise æ•°ç»„ã€‚

ä¸€äº›å¸¸ç”¨çš„è§£å†³æ–¹æ¡ˆå¦‚ Apollo å¯ä»¥å¸®çœç•¥ä¸€äº›ç®€å•çš„è§£æžå‡½æ•°ï¼Œæ¯”å¦‚ä¸€ä¸ªå­—æ®µæ²¡æœ‰æä¾›å¯¹åº”çš„è§£æžå‡½æ•°æ—¶ï¼Œä¼šä»Žä¸Šå±‚è¿”å›žå¯¹è±¡ä¸­è¯»å–å’Œè¿”å›žä¸Žè¿™ä¸ªå­—æ®µåŒåçš„å±žæ€§ã€‚

### 2.5 è¯·æ±‚æ ¼å¼

GraphQL æœ€å¸¸è§çš„æ˜¯é€šè¿‡ HTTP æ¥å‘é€è¯·æ±‚ï¼Œé‚£ä¹ˆå¦‚ä½•é€šè¿‡ HTTP æ¥è¿›è¡Œ GraphQL é€šä¿¡å‘¢

ä¸¾ä¸ªæ —å­ï¼Œå¦‚ä½•é€šè¿‡ Get/Post æ–¹å¼æ¥æ‰§è¡Œä¸‹é¢çš„ GraphQL æŸ¥è¯¢å‘¢

```graphql
query {
  me {
    name
  }
}
```

Get æ˜¯å°†è¯·æ±‚å†…å®¹æ”¾åœ¨ URL ä¸­ï¼ŒPost æ˜¯åœ¨ `content-type: application/json` æƒ…å†µä¸‹ï¼Œå°† JSON æ ¼å¼çš„å†…å®¹æ”¾åœ¨è¯·æ±‚ä½“é‡Œ

```text
# Get æ–¹å¼
http://myapi/graphql?query={me{name}}

# Post æ–¹å¼çš„è¯·æ±‚ä½“
{
  "query": "...",
  "operationName": "...",
  "variables": { "myVariable": "someValue", ... }
}
```

è¿”å›žçš„æ ¼å¼ä¸€èˆ¬ä¹Ÿæ˜¯ JSON ä½“

```json
# æ­£ç¡®è¿”å›ž
{
  "data": { ... }
}

# æ‰§è¡Œæ—¶å‘ç”Ÿé”™è¯¯
{
  "errors": [ ... ]
}
```

å¦‚æžœæ‰§è¡Œæ—¶å‘ç”Ÿé”™è¯¯ï¼Œåˆ™ errors æ•°ç»„é‡Œæœ‰è¯¦ç»†çš„é”™è¯¯ä¿¡æ¯ï¼Œæ¯”å¦‚é”™è¯¯ä¿¡æ¯ã€é”™è¯¯ä½ç½®ã€æŠ›é”™çŽ°åœºçš„è°ƒç”¨å †æ ˆç­‰ä¿¡æ¯ï¼Œæ–¹ä¾¿è¿›è¡Œå®šä½ã€‚

## 3. å®žæˆ˜

è¿™é‡Œä½¿ç”¨ [MongoDB](https://docs.mongodb.com/v3.6/) + [graph-pack](https://github.com/glennreyes/graphpack) è¿›è¡Œä¸€ä¸‹ç®€å•çš„å®žæˆ˜ï¼Œå¹¶åœ¨å®žæˆ˜ä¸­ä¸€èµ·å­¦ä¹ ä¸€ä¸‹ï¼Œè¯¦ç»†ä»£ç å‚è§ [Github](https://github.com/SHERlocked93/graphql-demo) ~

MongoDB æ˜¯ä¸€ä¸ªä½¿ç”¨çš„æ¯”è¾ƒå¤šçš„ NoSQLï¼Œå¯ä»¥æ–¹ä¾¿çš„åœ¨ç¤¾åŒºæ‰¾åˆ°å¾ˆå¤šçŽ°æˆçš„è§£å†³æ–¹æ¡ˆï¼ŒæŠ¥é”™äº†ä¹Ÿå®¹æ˜“æ‰¾åˆ°è§£å†³æ–¹æ³•ã€‚

graph-pack æ˜¯é›†æˆäº† Webpack + Express + Prisma + Babel + Apollo-server + Websocket çš„æ”¯æŒçƒ­æ›´æ–°çš„é›¶é…ç½® GraphQL æœåŠ¡çŽ¯å¢ƒï¼Œè¿™é‡Œå°†å…¶ç”¨æ¥æ¼”ç¤º GraphQL çš„ä½¿ç”¨ã€‚ 

### 3.1 çŽ¯å¢ƒéƒ¨ç½²

é¦–å…ˆæˆ‘ä»¬æŠŠ MongoDB å¯èµ·æ¥ï¼Œè¿™ä¸ªè¿‡ç¨‹å°±ä¸èµ˜è¿°äº†ï¼Œç½‘ä¸Šå¾ˆå¤šæ•™ç¨‹ï¼›

æ­ä¸€ä¸‹ graph-pack çš„çŽ¯å¢ƒ

```bash
npm i -S graphpack
```

åœ¨ `package.json` çš„ `scripts` å­—æ®µåŠ ä¸Šï¼š

```json
"scripts": {
    "dev": "graphpack",
    "build": "graphpack build"
}
```

åˆ›å»ºæ–‡ä»¶ç»“æž„ï¼š

```text
.
â”œâ”€â”€ src
â”‚Â Â  â”œâ”€â”€ db					// æ•°æ®åº“æ“ä½œç›¸å…³
â”‚Â Â  â”‚Â Â  â”œâ”€â”€ connect.js		// æ•°æ®åº“æ“ä½œå°è£…
â”‚Â Â  â”‚Â Â  â”œâ”€â”€ index.js		// DAO å±‚
â”‚Â Â  â”‚Â Â  â””â”€â”€ setting.js		// é…ç½®
â”‚Â Â  â”œâ”€â”€ resolvers			// resolvers
â”‚Â Â  â”‚Â Â  â””â”€â”€ index.js
â”‚Â Â  â””â”€â”€ schema.graphql		// schema
â””â”€â”€ package.json
```

è¿™é‡Œçš„ `schema.graphql` æ˜¯ 2.3 èŠ‚çš„ç¤ºä¾‹ä»£ç ï¼Œå…¶ä»–å®žçŽ°å‚è§  [Github](https://github.com/SHERlocked93/graphql-demo)ï¼Œä¸»è¦å…³æ³¨ `src/db`  ã€`src/resolvers`ã€`src/schema.graphql` è¿™ä¸‰ä¸ªåœ°æ–¹

1. `src/db`ï¼šæ•°æ®åº“æ“ä½œå±‚ï¼ŒåŒ…æ‹¬ DAO å±‚å’Œ Service å±‚ï¼ˆå¦‚æžœå¯¹åˆ†å±‚ä¸å¤ªäº†è§£å¯ä»¥çœ‹ä¸€ä¸‹æœ€åŽä¸€ç« ï¼‰
2. `src/resolvers`ï¼šResolver è§£æžå‡½æ•°å±‚ï¼Œç»™ GraphQL çš„ Queryã€Mutationã€Subscription è¯·æ±‚æä¾› resolver è§£æžå‡½æ•°
3. `src/schema.graphql`ï¼šSchema å±‚

ç„¶åŽ `npm run dev` ï¼Œæµè§ˆå™¨æ‰“å¼€ `http://localhost:4000/` å°±å¯ä»¥ä½¿ç”¨ GraphQL Playground å¼€å§‹è°ƒè¯•äº†ï¼Œå·¦è¾¹æ˜¯è¯·æ±‚ä¿¡æ¯æ ï¼Œå·¦ä¸‹æ˜¯è¯·æ±‚å‚æ•°æ å’Œè¯·æ±‚å¤´è®¾ç½®æ ï¼Œå³è¾¹æ˜¯è¿”å›žå‚æ•°æ ï¼Œè¯¦ç»†ç”¨æ³•å¯ä»¥å‚è€ƒ [Prisma æ–‡æ¡£](https://www.prisma.io/blog/introducing-graphql-playground-f1e0a018f05d/) 

![](https://i.loli.net/2019/03/12/5c8743667c908.png)

### 3.2 Query

é¦–å…ˆæˆ‘ä»¬æ¥è¯•è¯• `hello world`ï¼Œæˆ‘ä»¬åœ¨ `schema.graphql` ä¸­å†™ä¸Š Query çš„ä¸€ä¸ªå…¥å£ `hello`ï¼Œå®ƒæŽ¥å— String ç±»åž‹çš„è¿”å›žå€¼

```graphql
# src/schema.graphql

# Query å…¥å£
type Query {
    hello: String
}
```

åœ¨ `src/resolvers/index.js` ä¸­è¡¥å……å¯¹åº”çš„ Resolverï¼Œè¿™ä¸ª Resolver æ¯”è¾ƒç®€å•ï¼Œç›´æŽ¥è¿”å›žçš„ String

```javascript
// src/resolvers/index.js

export default {
    Query: {
        hello: () => 'Hello world!'
    }
}
```

æˆ‘ä»¬åœ¨ Playground ä¸­è¿›è¡Œ Query

```json
# è¯·æ±‚
query {
  hello
}

# è¿”å›žå€¼
{
  "data": {
    "hello": "Hello world!"
  }
}
```

Hello world æ€»æ˜¯å¦‚æ­¤æ„‰å¿«ï¼Œä¸‹é¢æˆ‘ä»¬æ¥è¿›è¡Œç¨å¾®å¤æ‚ä¸€ç‚¹çš„æŸ¥è¯¢

æŸ¥è¯¢å…¥å£ `users` æŸ¥æ‰¾æ‰€æœ‰ç”¨æˆ·åˆ—è¡¨ï¼Œè¿”å›žä¸€ä¸ªä¸å¯ç©ºä½†é•¿åº¦å¯ä»¥ä¸º 0 çš„æ•°ç»„ï¼Œæ•°ç»„ä¸­å¦‚æžœæœ‰å…ƒç´ ï¼Œåˆ™å¿…é¡»ä¸º User ç±»åž‹ï¼›å¦ä¸€ä¸ªæŸ¥è¯¢å…¥å£ `user` æŽ¥å—ä¸€ä¸ªå­—ç¬¦ä¸²ï¼ŒæŸ¥æ‰¾ ID ä¸ºè¿™ä¸ªå­—ç¬¦ä¸²çš„ç”¨æˆ·ï¼Œå¹¶è¿”å›žä¸€ä¸ª User ç±»åž‹çš„å¯ç©ºå­—æ®µ

```graphql
# src/schema.graphql

# Query å…¥å£
type Query {
    user(id: String): User
    users: [User]!
}

type User {
    id: ID!
    name: String!
    age: Int
    email: String!
}
```

å¢žåŠ å¯¹åº”çš„ Resolver

```javascript
// src/resolvers/index.js

import Db from '../db'

export default {
    Query: {
        user: (parent, { id }) => Db.user({ id }),
        users: (parent, args) => Db.users({})
    }
}
```

è¿™é‡Œçš„ä¸¤ä¸ªæ–¹æ³• `Db.user`ã€`Db.users` åˆ†åˆ«æ˜¯æŸ¥æ‰¾å¯¹åº”æ•°æ®çš„å‡½æ•°ï¼Œè¿”å›žçš„æ˜¯ Promiseï¼Œå¦‚æžœè¿™ä¸ª Promise è¢« resolveï¼Œé‚£ä¹ˆä¼ ç»™ resolve çš„æ•°æ®å°†è¢«ä½œä¸ºç»“æžœè¿”å›žã€‚

ç„¶åŽè¿›è¡Œä¸€æ¬¡æŸ¥è¯¢å°±å¯ä»¥æŸ¥æ‰¾æˆ‘ä»¬æ‰€å¸Œæœ›çš„æ‰€æœ‰ä¿¡æ¯

```json
# è¯·æ±‚
query {
  user(id: "2") {
    id
    name
    email
    age
  }
  users {
    id
    name
  }
}

# è¿”å›žå€¼
{
  "data": {
    "user": {
      "id": "2",
      "name": "æŽå››",
      "email": "mmmmm@qq.com",
      "age": 18
    },
    "users": [{
        "id": "1",
        "name": "å¼ ä¸‰"
      },{
        "id": "2",
        "name": "æŽå››"
      }]
  }
}
```

æ³¨æ„è¿™é‡Œï¼Œè¿”å›žçš„æ•°ç»„åªå¸Œæœ›æ‹¿åˆ° `id`ã€`name` è¿™ä¸¤ä¸ªå­—æ®µï¼Œå› æ­¤ GraphQL å¹¶æ²¡æœ‰è¿”å›žå¤šä½™çš„æ•°æ®ï¼Œæ€Žä¹ˆæ ·ï¼Œæ˜¯ä¸æ˜¯å¾ˆè´´å¿ƒå‘¢

### 3.3 Mutation

çŸ¥é“å¦‚ä½•æŸ¥è¯¢æ•°æ®ï¼Œè¿˜å¾—äº†è§£å¢žåŠ ã€åˆ é™¤ã€ä¿®æ”¹ï¼Œæ¯•ç«Ÿè¿™æ˜¯ CRUD å·¥ç¨‹å¸ˆå¿…å¤‡çš„å‡ æ¿æ–§ï¼Œä¸è¿‡è¿™é‡Œåªä»‹ç»æ¯”è¾ƒå¤æ‚çš„ä¿®æ”¹ï¼Œå¦å¤–ä¸¤ä¸ªæ–¹æ³•å¯ä»¥çœ‹ä¸€ä¸‹ [Github](https://github.com/SHERlocked93/graphql-demo) ä¸Šã€‚

```graphql
# src/schema.graphql

# Mutation å…¥å£
type Mutation {
    updateUser(id: ID!, name: String, email: String, age: Int): User!
}

type User {
    id: ID!
    name: String!
    age: Int
    email: String!
}
```

åŒç†ï¼ŒMutation ä¹Ÿéœ€è¦ Resolver æ¥å¤„ç†è¯·æ±‚

```javascript
// src/resolvers/index.js

import Db from '../db'

export default {
    Mutation: {
        updateUser: (parent, { id, name, email, age }) => Db.user({ id })
            .then(existUser => {
                if (!existUser)
                    throw new Error('æ²¡æœ‰è¿™ä¸ªidçš„äºº')
                return existUser
            })
            .then(() => Db.updateUser({ id, name, email, age }))
    }
}
```

Mutation å…¥å£ updateUser æ‹¿åˆ°å‚æ•°ä¹‹åŽé¦–å…ˆè¿›è¡Œä¸€æ¬¡ç”¨æˆ·æŸ¥è¯¢ï¼Œå¦‚æžœæ²¡æ‰¾åˆ°åˆ™æŠ›é”™ï¼Œè¿™ä¸ªé”™å°†ä½œä¸º error ä¿¡æ¯è¿”å›žç»™ç”¨æˆ·ï¼Œ`Db.updateUser` è¿™ä¸ªå‡½æ•°è¿”å›žçš„ä¹Ÿæ˜¯ Promiseï¼Œä¸è¿‡æ˜¯å°†æ”¹å˜ä¹‹åŽçš„ä¿¡æ¯è¿”å›ž

```json
# è¯·æ±‚
mutation UpdataUser ($id: ID!, $name: String!, $email: String!, $age: Int) {
  updateUser(id: $id, name: $name, email: $email, age: $age) {
    id
    name
    age
  }
}

# å‚æ•°
{"id": "2", "name": "çŽ‹äº”", "email": "xxxx@qq.com", "age": 19}

# è¿”å›žå€¼
{
  "data": {
    "updateUser": {
      "id": "2",
      "name": "çŽ‹äº”",
      "age": 19
    }
  }
}
```

è¿™æ ·å®Œæˆäº†å¯¹æ•°æ®çš„æ›´æ”¹ï¼Œä¸”æ‹¿åˆ°äº†æ›´æ”¹åŽçš„æ•°æ®ï¼Œå¹¶ç»™å®šå¸Œæœ›çš„å­—æ®µã€‚

 ### 3.4 Subscription

GraphQL è¿˜æœ‰ä¸€ä¸ªæœ‰æ„æ€çš„åœ°æ–¹å°±æ˜¯å®ƒå¯ä»¥è¿›è¡Œæ•°æ®è®¢é˜…ï¼Œå½“å‰ç«¯å‘èµ·è®¢é˜…è¯·æ±‚ä¹‹åŽï¼Œå¦‚æžœåŽç«¯å‘çŽ°æ•°æ®æ”¹å˜ï¼Œå¯ä»¥ç»™å‰ç«¯æŽ¨é€å®žæ—¶ä¿¡æ¯ï¼Œæˆ‘ä»¬ç”¨ä¸€ä¸‹çœ‹çœ‹ã€‚

ç…§ä¾‹ï¼Œåœ¨ Schema ä¸­å®šä¹‰ Subscription çš„å…¥å£

```graphql
# src/schema.graphql

# Subscription å…¥å£
type Subscription {
    subsUser(id: ID!): User
}

type User {
    id: ID!
    name: String!
    age: Int
    email: String!
}
```

è¡¥å……ä¸Šå®ƒçš„ Resolver

```javascript
// src/resolvers/index.js

import Db from '../db'

const { PubSub, withFilter } = require('apollo-server')
const pubsub = new PubSub()
const USER_UPDATE_CHANNEL = 'USER_UPDATE'

export default {
    Mutation: {
        updateUser: (parent, { id, name, email, age }) => Db.user({ id })
            .then(existUser => {
                if (!existUser)
                    throw new Error('æ²¡æœ‰è¿™ä¸ªidçš„äºº')
                return existUser
            })
            .then(() => Db.updateUser({ id, name, email, age }))
            .then(user => {
                pubsub.publish(USER_UPDATE_CHANNEL, { subsUser: user })
                return user
            })
    },
    Subscription: {
        subsUser: {
            subscribe: withFilter(
                (parent, { id }) => pubsub.asyncIterator(USER_UPDATE_CHANNEL),
                (payload, variables) => payload.subsUser.id === variables.id
            ),
            resolve: (payload, variables) => {
                console.log('ðŸš¢ æŽ¥æ”¶åˆ°æ•°æ®ï¼š ', payload)
            }
        }
    }
}
```

è¿™é‡Œçš„ `pubsub` æ˜¯ apollo-server é‡Œè´Ÿè´£è®¢é˜…å’Œå‘å¸ƒçš„ç±»ï¼Œå®ƒåœ¨æŽ¥å—è®¢é˜…æ—¶æä¾›ä¸€ä¸ªå¼‚æ­¥è¿­ä»£å™¨ï¼Œåœ¨åŽç«¯è§‰å¾—éœ€è¦å‘å¸ƒè®¢é˜…çš„æ—¶å€™å‘å‰ç«¯å‘å¸ƒ payloadã€‚`withFilter` çš„ä½œç”¨æ˜¯è¿‡æ»¤æŽ‰ä¸éœ€è¦çš„è®¢é˜…æ¶ˆæ¯ï¼Œè¯¦ç»†ç”¨æ³•å‚ç…§[è®¢é˜…è¿‡æ»¤å™¨](https://www.apollographql.com/docs/apollo-server/v2/features/subscriptions.html#subscription-filters)ã€‚

é¦–å…ˆæˆ‘ä»¬å‘å¸ƒä¸€ä¸ªè®¢é˜…è¯·æ±‚

```json
# è¯·æ±‚
subscription subsUser($id: ID!) {
  subsUser(id: $id) {
    id
    name
    age
    email
  }
}

# å‚æ•°
{ "id": "2" }
```

æˆ‘ä»¬ç”¨åˆšåˆšçš„æ•°æ®æ›´æ–°æ“ä½œæ¥è¿›è¡Œä¸€æ¬¡æ•°æ®çš„æ›´æ”¹ï¼Œç„¶åŽæˆ‘ä»¬å°†èŽ·å–åˆ°å¹¶æ‰“å°å‡º `pubsub.publish` å‘å¸ƒçš„ payloadï¼Œè¿™æ ·å°±å®Œæˆäº†æ•°æ®è®¢é˜…ã€‚

åœ¨ graph-pack ä¸­æ•°æ®æŽ¨é€æ˜¯åŸºäºŽ websocket æ¥å®žçŽ°çš„ï¼Œå¯ä»¥åœ¨é€šä¿¡çš„æ—¶å€™æ‰“å¼€ Chrome DevTools çœ‹ä¸€ä¸‹ã€‚

## 4. æ€»ç»“

ç›®å‰å‰åŽç«¯çš„ç»“æž„å¤§æ¦‚å¦‚ä¸‹å›¾ã€‚åŽç«¯é€šè¿‡ DAO å±‚ä¸Žæ•°æ®åº“è¿žæŽ¥å®žçŽ°æ•°æ®æŒä¹…åŒ–ï¼ŒæœåŠ¡äºŽå¤„ç†ä¸šåŠ¡é€»è¾‘çš„ Service å±‚ï¼ŒController å±‚æŽ¥å— API è¯·æ±‚è°ƒç”¨ Service å±‚å¤„ç†å¹¶è¿”å›žï¼›å‰ç«¯é€šè¿‡æµè§ˆå™¨ URL è¿›è¡Œè·¯ç”±å‘½ä¸­èŽ·å–ç›®æ ‡è§†å›¾çŠ¶æ€ï¼Œè€Œé¡µé¢è§†å›¾æ˜¯ç”±ç»„ä»¶åµŒå¥—ç»„æˆï¼Œæ¯ä¸ªç»„ä»¶ç»´æŠ¤ç€å„è‡ªçš„ç»„ä»¶çº§çŠ¶æ€ï¼Œä¸€äº›ç¨å¾®å¤æ‚çš„åº”ç”¨è¿˜ä¼šä½¿ç”¨é›†ä¸­å¼çŠ¶æ€ç®¡ç†çš„å·¥å…·ï¼Œæ¯”å¦‚ Vuexã€Reduxã€Mobx ç­‰ã€‚å‰åŽç«¯åªé€šè¿‡ API æ¥äº¤æµï¼Œè¿™ä¹Ÿæ˜¯çŽ°åœ¨å‰åŽç«¯åˆ†ç¦»å¼€å‘çš„åŸºç¡€ã€‚

![](https://i.loli.net/2019/03/08/5c82222d15d80.png)

å¦‚æžœä½¿ç”¨ GraphQLï¼Œé‚£ä¹ˆåŽç«¯å°†ä¸å†äº§å‡º APIï¼Œè€Œæ˜¯å°† Controller å±‚ç»´æŠ¤ä¸º Resolverï¼Œå’Œå‰ç«¯çº¦å®šä¸€å¥— Schemaï¼Œè¿™ä¸ª Schema å°†ç”¨æ¥ç”ŸæˆæŽ¥å£æ–‡æ¡£ï¼Œå‰ç«¯ç›´æŽ¥é€šè¿‡ Schema æˆ–ç”Ÿæˆçš„æŽ¥å£æ–‡æ¡£æ¥è¿›è¡Œè‡ªå·±æœŸæœ›çš„è¯·æ±‚ã€‚

ç»è¿‡å‡ å¹´ä¸€çº¿å¼€å‘è€…çš„å¡«å‘ï¼Œå·²ç»æœ‰ä¸€äº›ä¸é”™çš„[å·¥å…·é“¾](https://github.com/chentsulin/awesome-graphql)å¯ä»¥ä½¿ç”¨äºŽå¼€å‘ä¸Žç”Ÿäº§ï¼Œå¾ˆå¤šè¯­è¨€ä¹Ÿæä¾›äº†å¯¹ GraphQL çš„æ”¯æŒï¼Œæ¯”å¦‚ JavaScript/Nodejsã€Javaã€PHPã€Rubyã€Pythonã€Goã€C# ç­‰ã€‚

ä¸€äº›æ¯”è¾ƒæœ‰åçš„å…¬å¸æ¯”å¦‚ Twitterã€IBMã€Courseraã€Airbnbã€Facebookã€Githubã€æºç¨‹ç­‰ï¼Œå†…éƒ¨æˆ–å¤–éƒ¨ API ä»Ž RESTful è½¬ä¸ºäº† GraphQL é£Žæ ¼ï¼Œç‰¹åˆ«æ˜¯ Githubï¼Œå®ƒçš„ v4 ç‰ˆå¤–éƒ¨ API åªä½¿ç”¨ GraphQLã€‚æ®[ä¸€ä½åœ¨ Twitter å·¥ä½œçš„å¤§ä½¬](https://www.zhihu.com/question/38596306/answer/207364003)è¯´ç¡…è°·ä¸å°‘ä¸€çº¿äºŒçº¿çš„å…¬å¸éƒ½åœ¨æƒ³åŠžæ³•è½¬åˆ° GraphQL ä¸Šï¼Œä½†æ˜¯åŒæ—¶ä¹Ÿè¯´äº† GraphQL è¿˜éœ€è¦æ—¶é—´å‘å±•ï¼Œå› ä¸ºå°†å®ƒä½¿ç”¨åˆ°ç”Ÿäº§çŽ¯å¢ƒéœ€è¦å‰åŽç«¯å¤§é‡çš„é‡æž„ï¼Œè¿™æ— ç–‘éœ€è¦é«˜å±‚çš„æŽ¨åŠ¨å’Œå†³å¿ƒã€‚

æ­£å¦‚[å°¤é›¨æºªæ‰€è¯´](https://www.zhihu.com/question/38596306/answer/79714979)ï¼Œä¸ºä»€ä¹ˆ GraphQL ä¸¤ä¸‰å¹´å‰æ²¡æœ‰å¹¿æ³›ä½¿ç”¨èµ·æ¥å‘¢ï¼Œå¯èƒ½æœ‰ä¸‹é¢ä¸¤ä¸ªåŽŸå› ï¼š

> 1. GraphQL çš„ field resolve å¦‚æžœæŒ‰ç…§ naive çš„æ–¹å¼æ¥å†™ï¼Œæ¯ä¸€ä¸ª field éƒ½å¯¹æ•°æ®åº“ç›´æŽ¥è·‘ä¸€ä¸ª queryï¼Œä¼šäº§ç”Ÿå¤§é‡å†—ä½™ queryï¼Œè™½ç„¶ç½‘ç»œå±‚é¢çš„è¯·æ±‚æ•°è¢«ä¼˜åŒ–äº†ï¼Œä½†æ•°æ®åº“æŸ¥è¯¢å¯èƒ½ä¼šæˆä¸ºæ€§èƒ½ç“¶é¢ˆï¼Œè¿™é‡Œé¢æœ‰å¾ˆå¤§çš„ä¼˜åŒ–ç©ºé—´ï¼Œä½†å¹¶ä¸æ˜¯é‚£ä¹ˆå®¹æ˜“åšã€‚FB æœ¬èº«æ²¡æœ‰è¿™ä¸ªé—®é¢˜ï¼Œå› ä¸ºä»–ä»¬å†…éƒ¨æ•°æ®åº“è¿™ä¸€å±‚ä¹Ÿæ˜¯æŠ½è±¡æŽ‰çš„ï¼Œå†™ GraphQL æŽ¥å£çš„äººä¸éœ€è¦é¡¾è™‘ query ä¼˜åŒ–çš„é—®é¢˜ã€‚
> 2. GraphQL çš„åˆ©å¥½ä¸»è¦æ˜¯åœ¨äºŽå‰ç«¯çš„å¼€å‘æ•ˆçŽ‡ï¼Œä½†è½åœ°å´éœ€è¦æœåŠ¡ç«¯çš„å…¨åŠ›é…åˆã€‚å¦‚æžœæ˜¯å°å…¬å¸æˆ–è€…æ•´ä¸ªå…¬å¸éƒ½æ˜¯å…¨æ ˆï¼Œé‚£å¯èƒ½å¯ä»¥åšï¼Œä½†åœ¨å¾ˆå¤šå‰åŽç«¯åˆ†å·¥æ¯”è¾ƒæ˜Žç¡®çš„å›¢é˜Ÿé‡Œï¼Œè¦æŽ¨åŠ¨ GraphQL è¿˜æ˜¯ä¼šé‡åˆ°å„ç§åä½œä¸Šçš„é˜»åŠ›ã€‚

å¤§çº¦å¯ä»¥æ¦‚æ‹¬ä¸ºæ€§èƒ½ç“¶é¢ˆå’Œå›¢é˜Ÿåˆ†å·¥çš„åŽŸå› ï¼Œå¸Œæœ›éšç€ç¤¾åŒºçš„å‘å±•ï¼ŒåŸºç¡€è®¾æ–½çš„å®Œå–„ï¼Œä¼šæ¸æ¸æœ‰å®Œå–„çš„è§£å†³æ–¹æ¡ˆæå‡ºï¼Œè®©å¹¿å¤§å‰åŽç«¯å¼€å‘è€…ä»¬å¯ä»¥æ—©æ—¥ç”¨ä¸Šæ­¤åˆ©å™¨ã€‚



---
ç½‘ä¸Šçš„å¸–å­å¤§å¤šæ·±æµ…ä¸ä¸€ï¼Œç”šè‡³æœ‰äº›å‰åŽçŸ›ç›¾ï¼Œåœ¨ä¸‹çš„æ–‡ç« éƒ½æ˜¯å­¦ä¹ è¿‡ç¨‹ä¸­çš„æ€»ç»“ï¼Œå¦‚æžœå‘çŽ°é”™è¯¯ï¼Œæ¬¢è¿Žç•™è¨€æŒ‡å‡º~



> å‚è€ƒï¼š
>
> 1. [GraphQL \| ä¸€ç§ä¸ºä½ çš„ API è€Œç”Ÿçš„æŸ¥è¯¢è¯­è¨€](http://graphql.cn/)
> 2. [JSON\-RPC 2\.0 è§„èŒƒ \- wiki \. leozvc](http://wiki.geekdream.com/Specification/json-rpc_2.0.html)
> 3. [GraphQL ä¸ºä½•æ²¡æœ‰ç«èµ·æ¥? - å°¤é›¨æºªçš„å›žç­” - çŸ¥ä¹Ž](https://www.zhihu.com/question/38596306/answer/79714979)
> 4. [GraphQLä»€ä¹ˆé¬¼ \| kazaff's blog](https://blog.kazaff.me/2016/01/01/GraphQL%E4%BB%80%E4%B9%88%E9%AC%BC/)
